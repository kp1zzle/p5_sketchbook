(self.webpackChunkp5_webpack_boilerplate=self.webpackChunkp5_webpack_boilerplate||[]).push([[7286],{7260:e=>{e.exports="precision highp float;\n\n#define MAX_EFFECTS 10\n\nuniform vec2 u_resolution;\nuniform sampler2D u_pixelArray;\nuniform bool u_moveUp;\nuniform bool u_moveDown;\nuniform bool u_moveLeft;\nuniform bool u_moveRight;\nuniform bool u_invert;\nuniform vec2 u_kernelResolution;\nuniform sampler2D u_kernel;\nuniform bool u_penDown;\nuniform float u_frameMultiplier;\n\nvarying vec2 vTexCoord;\n\nvec4 lerpBlend(vec4 top, vec4 back) {\n    return vec4((top.rgb * top.a + back.rgb * (1. - top.a)), 1);\n}\n\nvoid main() {\n    vec2 singlePixel = u_frameMultiplier / u_resolution;\n    vec2 coord = vTexCoord;\n    if (u_moveUp) {\n        coord.y -= singlePixel.y;\n    }\n\n    if (u_moveDown) {\n        coord.y += singlePixel.y;\n    }\n\n    if (u_moveLeft) {\n        coord.x -= singlePixel.x;\n    }\n\n    if (u_moveRight) {\n        coord.x += singlePixel.x;\n    }\n\n    coord = mod(coord, vec2(1,1));\n\n    gl_FragColor = texture2D(u_pixelArray, coord);\n\n    if (u_penDown) {\n        vec2 kernelRatio = u_kernelResolution / u_resolution;\n        vec2 kernelEdges = vec2(0.5 - kernelRatio.x/2., 0.5 - kernelRatio.y/2.);\n        vec2 kernelTexCoord = (coord - kernelEdges) / kernelRatio;\n        if (vTexCoord.x >= kernelEdges.x && vTexCoord.x < kernelEdges.x + kernelRatio.x\n        && vTexCoord.y >= kernelEdges.y && vTexCoord.y < kernelEdges.y + kernelRatio.y) {\n            gl_FragColor = lerpBlend(texture2D(u_kernel, kernelTexCoord), gl_FragColor);\n        }\n    }\n\n\n    if (u_invert) {\n        gl_FragColor = vec4(1.0 - gl_FragColor.r,1.0 -gl_FragColor.g,1.0 -gl_FragColor.b,1);\n    }\n\n\n}\n\n"},5934:e=>{e.exports="// Determines how much precision the GPU uses when calculating floats\nprecision highp float;\n\n// Get the position attribute of the geometry\nattribute vec3 aPosition;\n\n// Get the texture coordinate attribute from the geometry\nattribute vec2 aTexCoord;\n\n// The view matrix defines attributes about the camera, such as focal length and camera position\n// Multiplying uModelViewMatrix * vec4(aPosition, 1.0) would move the object into its world position in front of the camera\nuniform mat4 uModelViewMatrix;\n\n// uProjectionMatrix is used to convert the 3d world coordinates into screen coordinates\nuniform mat4 uProjectionMatrix;\n\nvarying vec2 vTexCoord;\n\nvoid main(void) {\n    vec4 positionVec4 = vec4(aPosition, 1.0);\n    gl_Position = uProjectionMatrix * uModelViewMatrix * positionVec4;\n    vTexCoord = aTexCoord;\n}"},7286:(e,r,o)=>{"use strict";o.d(r,{h:()=>a});var n=o(363),t=o.n(n);class i{#e;#r;#o;#n;#t;#i;#a;#s;p5;constructor(e,r,o="webm"){this.p5=e,this.format=o,this.input=r}get blob(){return this.#e}get stream(){return this.#i}get input(){return this.#o}set input(e){if(void 0!==this.#i&&this.#i===e)return;if(this.recording)return console.error("VideoRecorder input was assigned a new value while recording.           Call stop() before changing the input");if(void 0===e)return void 0===this.p5.drawingContext?.canvas?console.error("VideoRecorder couldn't find canvas to record"):this.input=this.p5.drawingContext.canvas,void("undefined"!=typeof soundOut&&void 0!==soundOut.output&&this.addInput(soundOut.output));const r=Array.isArray(e)?this.#l(e):this.#d(e);this.#o=e,this.#i=r,this.#c()}get format(){return this.#t.mimeType}set format(e){return"."===e.charAt(0)&&(e=e.slice(1)),0==i.isSupported(e)?console.error(`Video format ${e} is not supported on this browser`):this.recording?console.error("Can't set format while video recorder is recording"):(this.#n=e.split("/").length>1?e:`video/${e}`,void(void 0!==this.#i&&this.#c()))}get onFileReady(){return this.#s}set onFileReady(e){if("function"!=typeof e)return console.error("VideoRecorder onFileReady must be of type function but was assigned to "+typeof e);this.#s=e}get recording(){return void 0!==this.#t&&"recording"===this.#t.state}get url(){return this.#a}addInput(e){void 0!==this.#i?(this.#d(e).getTracks().forEach((e=>this.#i.addTrack(e))),this.#c()):this.input=e}#u(e){const{context:r}=e,o=r.createMediaStreamDestination();return e.connect(o),o.stream}erase(){if(this.recording)return console.error("erase() was called while the video recorder was recording. Call stop() before erasing.");this.#r=[]}canRecord(e){return i.canRecord(e)}static canRecord(e){return e instanceof MediaStream||e instanceof AudioNode||"function"==typeof e.captureStream||"function"==typeof e.elt?.captureStream}#m(){this.#e=new Blob(this.#r,{type:this.#t.mimeType}),this.#a=URL.createObjectURL(this.#e),"function"==typeof this.#s&&this.#s()}#c(){this.#t=new MediaRecorder(this.#i,{mimeType:this.#n}),this.#t.onstop=()=>this.#m(),this.#t.ondataavailable=e=>this.#r.push(e.data)}#l(e){return e.forEach((e=>this.addInput(e))),this.#i}#d(e){return 0==this.canRecord(e)?console.error(`Selected VideoRecorder input of type ${typeof e} cannot be recorded in this browser`):e instanceof MediaStream?e:e instanceof AudioNode?this.#u(e):"function"==typeof e.captureStream?this.#p(e):e instanceof this.p5.Element?this.#p(e.elt):void 0}isSupported(e){return i.isSupported(e)}static isSupported(e){return"."===e.charAt(0)&&(e=e.slice(1)),MediaRecorder.isTypeSupported(e.split("/").length>1?e:`video/${e}`)}#p(e){return"function"!=typeof e.captureStream?console.error(`Can't capture stream from input ${e}`):e.captureStream()}pause(){this.#t.pause()}resume(){this.#t.resume()}save(e){if(void 0===this.#e)return console.error("save() was called before a video file was created.          Use onFileReady event to call a function when the video file is ready.");let r=this.#n.match(/\/([^;]*)/)?.[1];[e,r]=this.p5._checkFileExtension(e,r),this.p5.downloadFile(this.#e,e,r)}start(){this.erase(),this.#t.start()}stop(){console.assert(this.recording,"stop() was called while the video recorder was not recording. Call start() before stopping."),this.#t.stop()}}function a(e,r,n,a,s){return void 0===e&&(e=!0),void 0===r&&(r=""),void 0===n&&(n=!0),void 0===a&&(a=!0),void 0===s&&(s=[255,255,255]),function(l){var d,c=null,u=null,m=null,p=null,h=0,f=[],k=!1,g=!1,v=!1,b=!1,w=["solid","dots","triangle"],y={bufWidth:500,bufHeight:500,kernelSize:10,frameMultiplier:1,invert:!1,penDown:n,kernelMode:"solid",kernelColor:[40,3,252],kernelParam:2,manualModeEnabled:a};l.setup=function(){l.createCanvas(l.min(l.windowWidth,l.windowHeight),l.min(l.windowWidth,l.windowHeight)),l.noSmooth(),(u=l.createGraphics(y.bufWidth,y.bufHeight,l.WEBGL)).rectMode(l.CENTER),u.noStroke(),u.background(s),c=u.createShader(o(5934),o(7260)),m=l.createGraphics(y.kernelSize,y.kernelSize),x(),(p=new i(l,void 0,"mp4")).onFileReady=function(){p.save(document.title+"_"+(new Date).toISOString())},e&&C(),l.frameRate(60),""!==r&&(f=R(r),console.log(f))};var C=function(){(d=t().create(10,10,"settings")).hide(),d.bindRange("bufWidth",0,1e3,y.bufWidth,1,y),d.bindRange("frameMultiplier",1,10,y.frameMultiplier,1,y),d.addRange("kernelSize",1,100,y.kernelSize,1,(function(e){y.kernelSize=e,x()})),d.addDropDown("kernel mode",w,(function(e){y.kernelMode=e.value,x()})),d.addButton("invert",(function(){y.invert=!0})),d.addButton("toggle pen up/down",(function(){y.penDown=!y.penDown})),d.addRange("kernelParam",1,100,y.kernelParam,1,(function(e){y.kernelParam=e,x()})),d.addButton("start recording",(function(){p.start(),d.hideControl("start recording"),d.showControl("stop recording")})),d.addButton("stop recording",(function(){p.stop(),d.hideControl("stop recording"),d.showControl("start recording")})),d.hideControl("stop recording"),d.addTextArea("commands",""),d.addButton("execute commands",(function(){f=R(d.getValue("commands")),d.disableControl("commands"),d.hideControl("execute commands"),d.showControl("stop command execution")})),d.addButton("stop command execution",(function(){f=[],d.enableControl("commands"),d.hideControl("stop command execution"),d.showControl("execute commands")})),d.hideControl("stop command execution"),d.bindBoolean("manual mode",y.manualModeEnabled,y)},x=function(){m=l.createGraphics(y.kernelSize,y.kernelSize);var e=l.color(y.kernelColor);switch(m.fill(e),m.stroke(e),y.kernelMode){case"solid":T();break;case"dots":D(y.kernelParam);break;case"triangle":P(y.kernelParam)}};function S(e){return y.manualModeEnabled&&l.keyIsDown(e)}l.draw=function(){if(l.background(s),f.length>0&&M(),c.setUniform("u_resolution",[y.bufWidth,y.bufHeight]),c.setUniform("u_pixelArray",u),c.setUniform("u_kernel",m),c.setUniform("u_kernelResolution",[y.kernelSize,y.kernelSize]),c.setUniform("u_moveUp",S(87)||k),c.setUniform("u_moveDown",S(83)||g),c.setUniform("u_moveLeft",S(65)||v),c.setUniform("u_moveRight",S(68)||b),c.setUniform("u_invert",y.invert),c.setUniform("u_penDown",y.penDown),c.setUniform("u_frameMultiplier",y.frameMultiplier),y.invert=!1,k=!1,g=!1,v=!1,b=!1,u.shader(c),u.rect(0,0,y.bufWidth,y.bufHeight),l.image(u,0,0,l.width,l.height),!y.penDown){var e=l.min(l.width,l.height)/y.bufWidth*y.kernelSize;l.image(m,l.width/2-e/2,l.height/2-e/2,e,e)}},l.mouseClicked=function(){},l.mouseDragged=function(){},l.windowResized=function(){l.resizeCanvas(l.min(l.windowWidth,l.windowHeight),l.min(l.windowWidth,l.windowHeight))},l.keyPressed=function(){l.keyCode===l.ESCAPE&&d.toggleVisibility(),y.manualModeEnabled&&("e"==l.key&&y.frameMultiplier++,"q"==l.key&&y.frameMultiplier--," "==l.key&&(y.kernelMode=l.random(w),x()),"r"==l.key&&(y.invert=!0),"f"==l.key&&(y.penDown=!y.penDown),"="==l.key&&(y.kernelParam--,x()),"-"==l.key&&(y.kernelParam++,x()),"0"==l.key&&(y.kernelColor=[0,0,0],x()),"9"==l.key&&(y.kernelColor=[40,3,252],x()),"8"==l.key&&(y.kernelColor=[224,6,245],x()),"7"==l.key&&(y.kernelColor=[200,245,66],x()),"6"==l.key&&(y.kernelColor=[227,7,7],x()),"5"==l.key&&(y.kernelColor=[79,196,100],x()))};var _=function(e){for(var r=[],o=0;o<e.length;o++){var n=e[o].split(" "),t=parseInt(n[0]);if(isNaN(t)&&(t=1),isNaN(t)||2!==n.length||"("!==n[1]){for(var i=[],a=0,s=n;a<s.length;a++){var l=s[a];i.push(l.split("="))}for(u=0;u<t;u++)r.push(i)}else{for(var d=e.lastIndexOf(")"),c=_(e.slice(o+1,d)),u=0;u<t;u++)r.push.apply(r,c);o=d}}return r},R=function(e){var r=e.split(/\r?\n/);return _(r)},M=function(){for(var e=!1,r=0,o=f[h];r<o.length;r++){var n=o[r];switch(n[0]){case"up":k=!0;break;case"down":g=!0;break;case"left":v=!0;break;case"right":b=!0;break;case"invert":y.invert=!0;break;case"togglePen":y.penDown=!y.penDown;break;case"penUp":y.penDown=!1;break;case"penDown":y.penDown=!0;break;case"frameMultiplier":y.frameMultiplier=parseInt(n[1]);break;case"kernelSize":case"kernelParam":y.kernelSize=parseInt(n[1]),e=!0;break;case"kernelMode":y.kernelMode=n[1],e=!0;break;case"kernelColor":var t=n[1].split(",");y.kernelColor=[parseInt(t[0]),parseInt(t[1]),parseInt(t[2])],e=!0}}e&&x(),h=(h+1)%f.length},T=function(){m.noStroke(),m.rect(0,0,y.kernelSize,y.kernelSize)},D=function(e){m.noStroke();for(var r=0;r<y.kernelSize;r+=2*e)for(var o=0;o<y.kernelSize;o+=2*e)m.rect(r,o,e)},P=function(e){m.noStroke();var r=[[0,0],[y.kernelSize,0],[y.kernelSize,y.kernelSize],[0,y.kernelSize]],o=r[e%4],n=r[(e+1)%4],t=r[(e+2)%4];m.triangle(o[0],o[1],n[0],n[1],t[0],t[1])}}}}}]);